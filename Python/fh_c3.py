import numpy as np
from scipy import interpolate

# Points are (C3 (km2/sec2), payload mass (kg))
fh_expendable_points = np.array(
    [
        [-1.6827266989269773, 15510.739889865039],
        [0.17147065011572948, 14968.824649911681],
        [5.115996914229626, 13581.644174045556],
        [10.148818290202698, 12314.228651250854],
        [15.093344554316594, 11154.369032913502],
        [20.12616593028966, 10074.74030546866],
        [25.070692194403563, 9104.993015550514],
        [30.103513570376634, 8202.395493009792],
        [35.13633494634969, 7378.284711559569],
        [40.16915632232276, 6615.21917317973],
        [45.201977698295835, 5913.198877870282],
        [50.14650396240974, 5253.910252710102],
        [55.17932533838281, 4644.329896907238],
        [60.03555649063752, 4092.3064845707395],
        [65.15667297846977, 3551.620045947313],
        [70.10119924258366, 3066.7464009882387],
        [75.13402061855673, 2608.035003059331],
        [80.1668419945298, 2184.2066011706447],
        [85.11136825864371, 1786.540446312123],
        [90.1644575355916, 1416.2653398137008],
        [95.08871589873067, 1073.183177289604],
        [100.12153727470374, 747.0271643135347],
    ]
).T

fh_recovery_points = np.array(
    [
        [-1.6310867989807463, 6994.9019290934175],
        [0.12371134020619934, 6663.183292735035],
        [5.095729013254797, 5841.622701192571],
        [10.148818290202698, 5124.327818889204],
        [15.16137176520094, 4461.550894125003],
        [20.14643383126449, 3830.750049064338],
        [25.15898730626273, 3262.804631671328],
        [30.103513570376634, 2723.2149247873185],
        [35.13633494634969, 2237.046443703057],
        [40.16915632232276, 1793.0016970480865],
        [45.045655375552315, 1372.5955599681656],
        [50.078476751525386, 1003.1510009945086],
        [55.15905743740798, 649.3377554436956],
        [60.1238516024967, 313.381281675378],
    ]
).T

# Functions to compute payload mass for a given C3
fh_expendable_mass = interpolate.CubicSpline(
    fh_expendable_points[0], fh_expendable_points[1], extrapolate=False
)
fh_recovery_mass = interpolate.CubicSpline(fh_recovery_points[0], fh_recovery_points[1])

if __name__ == "__main__":
    c3 = 40  # km2/sec2
    mass = fh_expendable_mass(c3)

    print(f"C3={c3} km2/sec2, mass={mass} kg")
